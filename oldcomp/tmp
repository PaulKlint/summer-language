: compile the SUMMER program on "prog.sm" and optionally
: preserve some of the intermediate files with the indicated suffixes.

: The shell variables have the following meaning
: SUMMERBIN	directory where the standard SUMMER system resides.
: PARSER	-
: INT		-
: CC		- C compiler to be used either "cc" or "pcc".
SUMMERBIN=/grp/ai/paulk/summer/bin
CC=cc
PARSER=${PARSER-$SUMMERBIN/parser}
INT=${INT-$SUMMERBIN/int.a}
: First extract the name of the source file "prog" from the argument list.
if /bin/test x${prog}x = xx
then
	echo "Usage: sumc file"
	exit
fi
base=`basename $prog .sm`
: if basename modified "prog" and "prog" was not of the form $base.sm
: we must recover the lost prefix
if /bin/test $prog != $base -a $prog != $base.sm
then	dir=`echo $prog | sed "s/[^\/]*$//"`
fi
prog=$dir$base
: remove intermediate files on unexpected signals. quit leaves all files intact
trap "rm $prog.cs $prog.dc $prog.gl $prog.ic $prog.im $prog.in $prog.in\
$prog.s $prog.st $prog.o >/dev/null" 1 2 4 5 6 7 8 9 10 11 12 13 14 15
: Parse the program. Error messages are written to "prog.er".
